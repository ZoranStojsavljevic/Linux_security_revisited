## SELinux (Security Enhanced Linux) on Debian 10 Buster
https://linuxhint.com/selinux_debian_10/

SELinux is a labeling system for processes and files.  Labeled subjects access to labeled objects is
restricted by rules forming policies. This tutorial is an introduction to SELinux basics showing how
to setup and enable SELinux on Debian 10 Buster and enable it with some additional information on
popular commands.

Before starting you’ll need to learn the following concepts:

	Subjects: processes or users.
	Objects: files or filesystems.

### Type Enforcement:

On SELinux all subjects and objects have a type identifier ending with _t. “Type enforcement is the
notion that, in a mandatory access control system, access is governed through clearance based on a
subject-access-object set of rules.

In SELinux, type enforcement is implemented based on the labels of the subjects and objects. SELinux
by itself does not have rules that say /bin/bash can execute /bin/ls. Instead, it has rules similar
to “Processes with the label user_t can execute regular files labeled bin_t.”
(source https://wiki.gentoo.org/wiki/SELinux/Type_enforcement)

### Discretionary Access Control (DAC):

DAC is the ownership and permission system we use in Linux to manage access to objects like files
or directories. The Discretionary Access Control has nothing to do with SELinux and is a different
security layer. For additional information on DAC visit Linux Permissions Explained:

https://linuxhint.com/linux_permissions_explained/

### Mandatory Access Control (MAC):

Is a type of access control which restricts subjects access interaction with objects. Contrary to DAC
with MAC users can’t change policies.

Subjects and objects have a security context (security attributes) monitored by SELinux and
administered according to security policies made by rules to be enforced.

### Role Based Access Control (RBAC):

Is a type of access control based on roles, it can be combined with both MAC and DAC. RBAC policies
make management of many users within an organization simple in contrast to DAC which can derive in
individual permission assignments, it makes auditing, configuration and policy updates easier.

### Enforcing mode:

SELinux restricts subjects access to objects based on policies.

Permissive mode: SELinux only logs illegitimate activity.

### SELinux features include (Wikipedia list):

	Clean separation of policy from enforcement
	Well-defined policy interfaces
	Support for applications querying the policy and enforcing access control (for example, crond running jobs in the correct context)
	Independence of specific policies and policy languages
	Independence of specific security-label formats and contents
	Individual labels and controls for kernel objects and services
	Support for policy changes
	Separate measures for protecting system integrity (domain-type) and data confidentiality (multilevel security)
	Flexible policy
	Controls over process initialization and inheritance, and program execution
	Controls over file systems, directories, files, and open file descriptors
	Controls over sockets, messages, and network interfaces
	Controls over the use of “capabilities”
	Cached information on access-decisions via the Access Vector Cache (AVC)
	Default-deny policy (anything not explicitly specified in the policy is disallowed).

Source: https://en.wikipedia.org/wiki/Security-Enhanced_Linux#Features

Note: users are different on SELinux and passwd.

### Setting up SELinux on Debian 10 Buster

In my case SELinux was disabled on Debian 10 Buster. Keeping SELinux enabled is one of the basic steps
to keep a Linux device safe. To know the status of SELinux in your device run the command:

	# sestatus

I found SELinux was disabled, to enable it you need to install some packages before, after an apt
update, run the command:

	# apt install selinux-basics selinux-policy-default

#### BBB Debian Buster SELinux installation example

```
root@arm:/home/debian# uname -a
Linux arm 5.7.0-rc6-bone5 #1 PREEMPT Tue May 26 20:31:29 CEST 2020 armv7l GNU/Linux
root@arm:/home/debian# apt install selinux-basics selinux-policy-default
Reading package lists... Done
Building dependency tree       
Reading state information... Done
The following additional packages will be installed:
  checkpolicy gawk gdal-data libaec0 libarmadillo9 libarpack2 libauparse0 libcharls2 libdap25 libdapclient6v5 libdapserver7v5 libepsilon1 libfreexl1 libfyba0
  libgdal20 libgeos-3.7.1 libgeos-c1v5 libgeotiff2 libgif7 libhdf4-0-alt libhdf5-103 libimagequant0 libkmlbase1 libkmlconvenience1 libkmldom1 libkmlengine1
  libkmlregionator1 libkmlxsd1 liblapack3 liblcms2-2 libminizip1 libnetcdf13 libnspr4 libnss3 libodbc1 libogdi3.2 libopenjp2-7 libpoppler82 libpq5 libproj13
  libqhull7 libspatialite7 libsuperlu5 libsz2 liburiparser1 libwebpdemux2 libwebpmux3 libxerces-c3.2 libyaml-0-2 odbcinst odbcinst1debian2 policycoreutils
  policycoreutils-dev policycoreutils-python-utils poppler-data proj-bin proj-data python3-audit python3-decorator python3-gdal python3-ipy python3-networkx
  python3-numpy python3-olefile python3-pil python3-pkg-resources python3-scipy python3-selinux python3-semanage python3-sepolgen python3-sepolicy
  python3-setools python3-yaml selinux-policy-dev selinux-utils semodule-utils setools
Suggested packages:
  gawk-doc geotiff-bin gdal-bin libgeotiff-epsg libhdf4-doc libhdf4-alt-dev hdf4-tools liblcms2-utils libmyodbc odbc-postgresql tdsodbc unixodbc-bin ogdi-bin
  poppler-utils ghostscript fonts-japanese-mincho | fonts-ipafont-mincho fonts-japanese-gothic | fonts-ipafont-gothic fonts-arphic-ukai fonts-arphic-uming
  fonts-nanum python-networkx-doc gfortran python-numpy-doc python3-dev python3-pytest python3-numpy-dbg python-pil-doc python3-pil-dbg python3-setuptools
  python-scipy-doc logcheck syslog-summary setools-gui
The following NEW packages will be installed:
  checkpolicy gawk gdal-data libaec0 libarmadillo9 libarpack2 libauparse0 libcharls2 libdap25 libdapclient6v5 libdapserver7v5 libepsilon1 libfreexl1 libfyba0
  libgdal20 libgeos-3.7.1 libgeos-c1v5 libgeotiff2 libgif7 libhdf4-0-alt libhdf5-103 libimagequant0 libkmlbase1 libkmlconvenience1 libkmldom1 libkmlengine1
  libkmlregionator1 libkmlxsd1 liblapack3 liblcms2-2 libminizip1 libnetcdf13 libnspr4 libnss3 libodbc1 libogdi3.2 libopenjp2-7 libpoppler82 libpq5 libproj13
  libqhull7 libspatialite7 libsuperlu5 libsz2 liburiparser1 libwebpdemux2 libwebpmux3 libxerces-c3.2 libyaml-0-2 odbcinst odbcinst1debian2 policycoreutils
  policycoreutils-dev policycoreutils-python-utils poppler-data proj-bin proj-data python3-audit python3-decorator python3-gdal python3-ipy python3-networkx
  python3-numpy python3-olefile python3-pil python3-pkg-resources python3-scipy python3-selinux python3-semanage python3-sepolgen python3-sepolicy
  python3-setools python3-yaml selinux-basics selinux-policy-default selinux-policy-dev selinux-utils semodule-utils setools
0 upgraded, 79 newly installed, 0 to remove and 0 not upgraded.
3 not fully installed or removed.
Need to get 46.6 MB of archives.
After this operation, 164 MB of additional disk space will be used.
Do you want to continue? [Y/n] y
Get:1 http://deb.debian.org/debian buster/main armhf gawk armhf 1:4.2.1+dfsg-1 [622 kB]
Get:2 http://deb.debian.org/debian buster/main armhf poppler-data all 0.4.9-2 [1,473 kB]
Get:3 http://deb.debian.org/debian buster/main armhf checkpolicy armhf 2.8-1 [191 kB]
Get:4 http://deb.debian.org/debian buster/main armhf gdal-data all 2.4.0+dfsg-1 [744 kB]
Get:5 http://deb.debian.org/debian buster/main armhf libaec0 armhf 1.0.2-1 [21.9 kB]
Get:6 http://deb.debian.org/debian buster/main armhf liblapack3 armhf 3.8.0-2 [1,631 kB]
Get:7 http://deb.debian.org/debian buster/main armhf libarpack2 armhf 3.7.0-2 [88.1 kB]
Get:8 http://deb.debian.org/debian buster/main armhf libsuperlu5 armhf 5.2.1+dfsg1-4 [133 kB]
Get:9 http://deb.debian.org/debian buster/main armhf libarmadillo9 armhf 1:9.200.7+dfsg-1 [87.2 kB]
Get:10 http://deb.debian.org/debian buster/main armhf libauparse0 armhf 1:2.8.4-3 [62.3 kB]
Get:11 http://deb.debian.org/debian buster/main armhf libcharls2 armhf 2.0.0+dfsg-1 [55.0 kB]
Get:12 http://deb.debian.org/debian buster/main armhf libdap25 armhf 3.20.3-1 [484 kB]
Get:13 http://deb.debian.org/debian buster/main armhf libdapclient6v5 armhf 3.20.3-1 [188 kB]
Get:14 http://deb.debian.org/debian buster/main armhf libdapserver7v5 armhf 3.20.3-1 [128 kB]
Get:15 http://deb.debian.org/debian buster/main armhf libepsilon1 armhf 0.9.2+dfsg-4 [37.2 kB]
Get:16 http://deb.debian.org/debian buster/main armhf libfreexl1 armhf 1.0.5-3 [31.9 kB]
Get:17 http://deb.debian.org/debian buster/main armhf libfyba0 armhf 4.1.1-6 [100 kB]
Get:18 http://deb.debian.org/debian buster/main armhf libgeos-3.7.1 armhf 3.7.1-1 [648 kB]
Get:19 http://deb.debian.org/debian buster/main armhf libgeos-c1v5 armhf 3.7.1-1 [291 kB]
Get:20 http://deb.debian.org/debian buster/main armhf proj-data all 5.2.0-1 [6,986 kB]
Get:21 http://deb.debian.org/debian buster/main armhf libproj13 armhf 5.2.0-1 [187 kB]
Get:22 http://deb.debian.org/debian buster/main armhf libgeotiff2 armhf 1.4.3-1 [63.3 kB]
Get:23 http://deb.debian.org/debian buster/main armhf libgif7 armhf 5.1.4-3 [40.8 kB]
Get:24 http://deb.debian.org/debian buster/main armhf libhdf4-0-alt armhf 4.2.13-4 [239 kB]
Get:25 http://deb.debian.org/debian buster/main armhf libsz2 armhf 1.0.2-1 [6,584 B]
Get:26 http://deb.debian.org/debian buster/main armhf libhdf5-103 armhf 1.10.4+repack-10 [1,285 kB]
Get:27 http://deb.debian.org/debian buster/main armhf libminizip1 armhf 1.1-8+b1 [19.0 kB]
Get:28 http://deb.debian.org/debian buster/main armhf liburiparser1 armhf 0.9.1-1 [40.4 kB]
Get:29 http://deb.debian.org/debian buster/main armhf libkmlbase1 armhf 1.3.0-7 [42.0 kB]
Get:30 http://deb.debian.org/debian buster/main armhf libkmldom1 armhf 1.3.0-7 [156 kB]
Get:31 http://deb.debian.org/debian buster/main armhf libkmlengine1 armhf 1.3.0-7 [67.9 kB]
Get:32 http://deb.debian.org/debian buster/main armhf libkmlconvenience1 armhf 1.3.0-7 [44.8 kB]
Get:33 http://deb.debian.org/debian buster/main armhf libkmlregionator1 armhf 1.3.0-7 [22.4 kB]
Get:34 http://deb.debian.org/debian buster/main armhf libkmlxsd1 armhf 1.3.0-7 [30.4 kB]
Get:35 http://deb.debian.org/debian buster/main armhf libnetcdf13 armhf 1:4.6.2-1 [357 kB]
Get:36 http://deb.debian.org/debian buster/main armhf libodbc1 armhf 2.3.6-0.1 [191 kB]
Get:37 http://deb.debian.org/debian buster/main armhf libogdi3.2 armhf 3.2.1+ds-4 [198 kB]
Get:38 http://deb.debian.org/debian buster/main armhf libopenjp2-7 armhf 2.3.0-2+deb10u1 [143 kB]
Get:39 http://deb.debian.org/debian buster/main armhf liblcms2-2 armhf 2.9-3 [119 kB]
Get:40 http://deb.debian.org/debian buster/main armhf libnspr4 armhf 2:4.20-1 [90.0 kB]
Get:41 http://deb.debian.org/debian buster/main armhf libnss3 armhf 2:3.42.1-1+deb10u2 [969 kB]
Get:42 http://deb.debian.org/debian buster/main armhf libpoppler82 armhf 0.71.0-5 [1,381 kB]
Get:43 http://deb.debian.org/debian buster/main armhf libpq5 armhf 11.7-0+deb10u1 [152 kB]
Get:44 http://deb.debian.org/debian buster/main armhf libqhull7 armhf 2015.2-4 [176 kB]
Get:45 http://deb.debian.org/debian buster/main armhf libspatialite7 armhf 4.3.0a-5+b2 [1,306 kB]
Get:46 http://deb.debian.org/debian buster/main armhf libxerces-c3.2 armhf 3.2.2+debian-1+b1 [733 kB]
Get:47 http://deb.debian.org/debian buster/main armhf odbcinst armhf 2.3.6-0.1 [47.8 kB]
Get:48 http://deb.debian.org/debian buster/main armhf odbcinst1debian2 armhf 2.3.6-0.1 [71.1 kB]
Get:49 http://deb.debian.org/debian buster/main armhf libgdal20 armhf 2.4.0+dfsg-1+b1 [5,258 kB]
Get:50 http://deb.debian.org/debian buster/main armhf libimagequant0 armhf 2.12.2-1.1 [27.2 kB]
Get:51 http://deb.debian.org/debian buster/main armhf libwebpdemux2 armhf 0.6.1-2 [86.6 kB]
Get:52 http://deb.debian.org/debian buster/main armhf libwebpmux3 armhf 0.6.1-2 [94.1 kB]
Get:53 http://deb.debian.org/debian buster/main armhf libyaml-0-2 armhf 0.2.1-1 [40.6 kB]
Get:54 http://deb.debian.org/debian buster/main armhf selinux-utils armhf 2.8-1+b1 [96.0 kB]
Get:55 http://deb.debian.org/debian buster/main armhf policycoreutils armhf 2.8-1 [464 kB]
Get:56 http://deb.debian.org/debian buster/main armhf python3-selinux armhf 2.8-1+b1 [139 kB]
Get:57 http://deb.debian.org/debian buster/main armhf python3-decorator all 4.3.0-1.1 [14.5 kB]
Get:58 http://deb.debian.org/debian buster/main armhf python3-pkg-resources all 40.8.0-1 [153 kB]
Get:59 http://deb.debian.org/debian buster/main armhf python3-networkx all 2.2-1 [818 kB]
Get:60 http://deb.debian.org/debian buster/main armhf python3-setools armhf 4.2.0-1 [623 kB]
Get:61 http://deb.debian.org/debian buster/main armhf semodule-utils armhf 2.8-1 [33.1 kB]
Get:62 http://deb.debian.org/debian buster/main armhf python3-sepolgen all 2.8-3 [83.9 kB]
Get:63 http://deb.debian.org/debian buster/main armhf python3-sepolicy all 2.8-3 [50.7 kB]
Get:64 http://deb.debian.org/debian buster/main armhf policycoreutils-dev armhf 2.8-3 [107 kB]
Get:65 http://deb.debian.org/debian buster/main armhf python3-audit armhf 1:2.8.4-3 [64.4 kB]
Get:66 http://deb.debian.org/debian buster/main armhf python3-ipy all 1:0.83-1 [29.3 kB]
Get:67 http://deb.debian.org/debian buster/main armhf python3-semanage armhf 2.8-2 [57.1 kB]
Get:68 http://deb.debian.org/debian buster/main armhf policycoreutils-python-utils all 2.8-3 [70.9 kB]
Get:69 http://deb.debian.org/debian buster/main armhf proj-bin armhf 5.2.0-1 [101 kB]
Get:70 http://deb.debian.org/debian buster/main armhf python3-numpy armhf 1:1.16.2-1 [1,903 kB]
Get:71 http://deb.debian.org/debian buster/main armhf python3-gdal armhf 2.4.0+dfsg-1+b1 [550 kB]
Get:72 http://deb.debian.org/debian buster/main armhf python3-olefile all 0.46-1 [35.9 kB]
Get:73 http://deb.debian.org/debian buster/main armhf python3-pil armhf 5.4.1-2+deb10u1 [367 kB]
Get:74 http://deb.debian.org/debian buster/main armhf python3-scipy armhf 1.1.0-7 [9,090 kB]
Get:75 http://deb.debian.org/debian buster/main armhf python3-yaml armhf 3.13-2 [113 kB]                                                                        
Get:76 http://deb.debian.org/debian buster/main armhf selinux-basics all 0.5.6 [15.0 kB]
Get:77 http://deb.debian.org/debian buster/main armhf selinux-policy-default all 2:2.20190201-2 [3,367 kB]
Get:78 http://deb.debian.org/debian buster/main armhf selinux-policy-dev all 2:2.20190201-2 [489 kB]
Get:79 http://deb.debian.org/debian buster/main armhf setools armhf 4.2.0-1 [35.9 kB]
Fetched 46.6 MB in 18s (2,585 kB/s)
Extracting templates from packages: 100%
Selecting previously unselected package gawk.
(Reading database ... 53278 files and directories currently installed.)
Preparing to unpack .../00-gawk_1%3a4.2.1+dfsg-1_armhf.deb ...
Unpacking gawk (1:4.2.1+dfsg-1) ...
Selecting previously unselected package poppler-data.
Preparing to unpack .../01-poppler-data_0.4.9-2_all.deb ...
Unpacking poppler-data (0.4.9-2) ...
Selecting previously unselected package checkpolicy.
Preparing to unpack .../02-checkpolicy_2.8-1_armhf.deb ...
Unpacking checkpolicy (2.8-1) ...
Selecting previously unselected package gdal-data.
Preparing to unpack .../03-gdal-data_2.4.0+dfsg-1_all.deb ...
Unpacking gdal-data (2.4.0+dfsg-1) ...
Selecting previously unselected package libaec0:armhf.
Preparing to unpack .../04-libaec0_1.0.2-1_armhf.deb ...
Unpacking libaec0:armhf (1.0.2-1) ...
Selecting previously unselected package liblapack3:armhf.
Preparing to unpack .../05-liblapack3_3.8.0-2_armhf.deb ...
Unpacking liblapack3:armhf (3.8.0-2) ...
Selecting previously unselected package libarpack2:armhf.
Preparing to unpack .../06-libarpack2_3.7.0-2_armhf.deb ...
Unpacking libarpack2:armhf (3.7.0-2) ...
Selecting previously unselected package libsuperlu5:armhf.
Preparing to unpack .../07-libsuperlu5_5.2.1+dfsg1-4_armhf.deb ...
Unpacking libsuperlu5:armhf (5.2.1+dfsg1-4) ...
Selecting previously unselected package libarmadillo9.
Preparing to unpack .../08-libarmadillo9_1%3a9.200.7+dfsg-1_armhf.deb ...
Unpacking libarmadillo9 (1:9.200.7+dfsg-1) ...
Selecting previously unselected package libauparse0:armhf.
Preparing to unpack .../09-libauparse0_1%3a2.8.4-3_armhf.deb ...
Unpacking libauparse0:armhf (1:2.8.4-3) ...
Selecting previously unselected package libcharls2:armhf.
Preparing to unpack .../10-libcharls2_2.0.0+dfsg-1_armhf.deb ...
Unpacking libcharls2:armhf (2.0.0+dfsg-1) ...
Selecting previously unselected package libdap25:armhf.
Preparing to unpack .../11-libdap25_3.20.3-1_armhf.deb ...
Unpacking libdap25:armhf (3.20.3-1) ...
Selecting previously unselected package libdapclient6v5:armhf.
Preparing to unpack .../12-libdapclient6v5_3.20.3-1_armhf.deb ...
Unpacking libdapclient6v5:armhf (3.20.3-1) ...
Selecting previously unselected package libdapserver7v5:armhf.
Preparing to unpack .../13-libdapserver7v5_3.20.3-1_armhf.deb ...
Unpacking libdapserver7v5:armhf (3.20.3-1) ...
Selecting previously unselected package libepsilon1:armhf.
Preparing to unpack .../14-libepsilon1_0.9.2+dfsg-4_armhf.deb ...
Unpacking libepsilon1:armhf (0.9.2+dfsg-4) ...
Selecting previously unselected package libfreexl1:armhf.
Preparing to unpack .../15-libfreexl1_1.0.5-3_armhf.deb ...
Unpacking libfreexl1:armhf (1.0.5-3) ...
Selecting previously unselected package libfyba0:armhf.
Preparing to unpack .../16-libfyba0_4.1.1-6_armhf.deb ...
Unpacking libfyba0:armhf (4.1.1-6) ...
Selecting previously unselected package libgeos-3.7.1:armhf.
Preparing to unpack .../17-libgeos-3.7.1_3.7.1-1_armhf.deb ...
Unpacking libgeos-3.7.1:armhf (3.7.1-1) ...
Selecting previously unselected package libgeos-c1v5:armhf.
Preparing to unpack .../18-libgeos-c1v5_3.7.1-1_armhf.deb ...
Unpacking libgeos-c1v5:armhf (3.7.1-1) ...
Selecting previously unselected package proj-data.
Preparing to unpack .../19-proj-data_5.2.0-1_all.deb ...
Unpacking proj-data (5.2.0-1) ...
Selecting previously unselected package libproj13:armhf.
Preparing to unpack .../20-libproj13_5.2.0-1_armhf.deb ...
Unpacking libproj13:armhf (5.2.0-1) ...
Selecting previously unselected package libgeotiff2:armhf.
Preparing to unpack .../21-libgeotiff2_1.4.3-1_armhf.deb ...
Unpacking libgeotiff2:armhf (1.4.3-1) ...
Selecting previously unselected package libgif7:armhf.
Preparing to unpack .../22-libgif7_5.1.4-3_armhf.deb ...
Unpacking libgif7:armhf (5.1.4-3) ...
Selecting previously unselected package libhdf4-0-alt.
Preparing to unpack .../23-libhdf4-0-alt_4.2.13-4_armhf.deb ...
Unpacking libhdf4-0-alt (4.2.13-4) ...
Selecting previously unselected package libsz2:armhf.
Preparing to unpack .../24-libsz2_1.0.2-1_armhf.deb ...
Unpacking libsz2:armhf (1.0.2-1) ...
Selecting previously unselected package libhdf5-103:armhf.
Preparing to unpack .../25-libhdf5-103_1.10.4+repack-10_armhf.deb ...
Unpacking libhdf5-103:armhf (1.10.4+repack-10) ...
Selecting previously unselected package libminizip1:armhf.
Preparing to unpack .../26-libminizip1_1.1-8+b1_armhf.deb ...
Unpacking libminizip1:armhf (1.1-8+b1) ...
Selecting previously unselected package liburiparser1:armhf.
Preparing to unpack .../27-liburiparser1_0.9.1-1_armhf.deb ...
Unpacking liburiparser1:armhf (0.9.1-1) ...
Selecting previously unselected package libkmlbase1:armhf.
Preparing to unpack .../28-libkmlbase1_1.3.0-7_armhf.deb ...
Unpacking libkmlbase1:armhf (1.3.0-7) ...
Selecting previously unselected package libkmldom1:armhf.
Preparing to unpack .../29-libkmldom1_1.3.0-7_armhf.deb ...
Unpacking libkmldom1:armhf (1.3.0-7) ...
Selecting previously unselected package libkmlengine1:armhf.
Preparing to unpack .../30-libkmlengine1_1.3.0-7_armhf.deb ...
Unpacking libkmlengine1:armhf (1.3.0-7) ...
Selecting previously unselected package libkmlconvenience1:armhf.
Preparing to unpack .../31-libkmlconvenience1_1.3.0-7_armhf.deb ...
Unpacking libkmlconvenience1:armhf (1.3.0-7) ...
Selecting previously unselected package libkmlregionator1:armhf.
Preparing to unpack .../32-libkmlregionator1_1.3.0-7_armhf.deb ...
Unpacking libkmlregionator1:armhf (1.3.0-7) ...
Selecting previously unselected package libkmlxsd1:armhf.
Preparing to unpack .../33-libkmlxsd1_1.3.0-7_armhf.deb ...
Unpacking libkmlxsd1:armhf (1.3.0-7) ...
Selecting previously unselected package libnetcdf13:armhf.
Preparing to unpack .../34-libnetcdf13_1%3a4.6.2-1_armhf.deb ...
Unpacking libnetcdf13:armhf (1:4.6.2-1) ...
Selecting previously unselected package libodbc1:armhf.
Preparing to unpack .../35-libodbc1_2.3.6-0.1_armhf.deb ...
Unpacking libodbc1:armhf (2.3.6-0.1) ...
Selecting previously unselected package libogdi3.2.
Preparing to unpack .../36-libogdi3.2_3.2.1+ds-4_armhf.deb ...
Unpacking libogdi3.2 (3.2.1+ds-4) ...
Selecting previously unselected package libopenjp2-7:armhf.
Preparing to unpack .../37-libopenjp2-7_2.3.0-2+deb10u1_armhf.deb ...
Unpacking libopenjp2-7:armhf (2.3.0-2+deb10u1) ...
Selecting previously unselected package liblcms2-2:armhf.
Preparing to unpack .../38-liblcms2-2_2.9-3_armhf.deb ...
Unpacking liblcms2-2:armhf (2.9-3) ...
Selecting previously unselected package libnspr4:armhf.
Preparing to unpack .../39-libnspr4_2%3a4.20-1_armhf.deb ...
Unpacking libnspr4:armhf (2:4.20-1) ...
Selecting previously unselected package libnss3:armhf.
Preparing to unpack .../40-libnss3_2%3a3.42.1-1+deb10u2_armhf.deb ...
Unpacking libnss3:armhf (2:3.42.1-1+deb10u2) ...
Selecting previously unselected package libpoppler82:armhf.
Preparing to unpack .../41-libpoppler82_0.71.0-5_armhf.deb ...
Unpacking libpoppler82:armhf (0.71.0-5) ...
Selecting previously unselected package libpq5:armhf.
Preparing to unpack .../42-libpq5_11.7-0+deb10u1_armhf.deb ...
Unpacking libpq5:armhf (11.7-0+deb10u1) ...
Selecting previously unselected package libqhull7:armhf.
Preparing to unpack .../43-libqhull7_2015.2-4_armhf.deb ...
Unpacking libqhull7:armhf (2015.2-4) ...
Selecting previously unselected package libspatialite7:armhf.
Preparing to unpack .../44-libspatialite7_4.3.0a-5+b2_armhf.deb ...
Unpacking libspatialite7:armhf (4.3.0a-5+b2) ...
Selecting previously unselected package libxerces-c3.2:armhf.
Preparing to unpack .../45-libxerces-c3.2_3.2.2+debian-1+b1_armhf.deb ...
Unpacking libxerces-c3.2:armhf (3.2.2+debian-1+b1) ...
Selecting previously unselected package odbcinst.
Preparing to unpack .../46-odbcinst_2.3.6-0.1_armhf.deb ...
Unpacking odbcinst (2.3.6-0.1) ...
Selecting previously unselected package odbcinst1debian2:armhf.
Preparing to unpack .../47-odbcinst1debian2_2.3.6-0.1_armhf.deb ...
Unpacking odbcinst1debian2:armhf (2.3.6-0.1) ...
Selecting previously unselected package libgdal20.
Preparing to unpack .../48-libgdal20_2.4.0+dfsg-1+b1_armhf.deb ...
Unpacking libgdal20 (2.4.0+dfsg-1+b1) ...
Selecting previously unselected package libimagequant0:armhf.
Preparing to unpack .../49-libimagequant0_2.12.2-1.1_armhf.deb ...
Unpacking libimagequant0:armhf (2.12.2-1.1) ...
Selecting previously unselected package libwebpdemux2:armhf.
Preparing to unpack .../50-libwebpdemux2_0.6.1-2_armhf.deb ...
Unpacking libwebpdemux2:armhf (0.6.1-2) ...
Selecting previously unselected package libwebpmux3:armhf.
Preparing to unpack .../51-libwebpmux3_0.6.1-2_armhf.deb ...
Unpacking libwebpmux3:armhf (0.6.1-2) ...
Selecting previously unselected package libyaml-0-2:armhf.
Preparing to unpack .../52-libyaml-0-2_0.2.1-1_armhf.deb ...
Unpacking libyaml-0-2:armhf (0.2.1-1) ...
Selecting previously unselected package selinux-utils.
Preparing to unpack .../53-selinux-utils_2.8-1+b1_armhf.deb ...
Unpacking selinux-utils (2.8-1+b1) ...
Selecting previously unselected package policycoreutils.
Preparing to unpack .../54-policycoreutils_2.8-1_armhf.deb ...
Unpacking policycoreutils (2.8-1) ...
Selecting previously unselected package python3-selinux.
Preparing to unpack .../55-python3-selinux_2.8-1+b1_armhf.deb ...
Unpacking python3-selinux (2.8-1+b1) ...
Selecting previously unselected package python3-decorator.
Preparing to unpack .../56-python3-decorator_4.3.0-1.1_all.deb ...
Unpacking python3-decorator (4.3.0-1.1) ...
Selecting previously unselected package python3-pkg-resources.
Preparing to unpack .../57-python3-pkg-resources_40.8.0-1_all.deb ...
Unpacking python3-pkg-resources (40.8.0-1) ...
Selecting previously unselected package python3-networkx.
Preparing to unpack .../58-python3-networkx_2.2-1_all.deb ...
Unpacking python3-networkx (2.2-1) ...
Selecting previously unselected package python3-setools.
Preparing to unpack .../59-python3-setools_4.2.0-1_armhf.deb ...
Unpacking python3-setools (4.2.0-1) ...
Selecting previously unselected package semodule-utils.
Preparing to unpack .../60-semodule-utils_2.8-1_armhf.deb ...
Unpacking semodule-utils (2.8-1) ...
Selecting previously unselected package python3-sepolgen.
Preparing to unpack .../61-python3-sepolgen_2.8-3_all.deb ...
Unpacking python3-sepolgen (2.8-3) ...
Selecting previously unselected package python3-sepolicy.
Preparing to unpack .../62-python3-sepolicy_2.8-3_all.deb ...
Unpacking python3-sepolicy (2.8-3) ...
Selecting previously unselected package policycoreutils-dev.
Preparing to unpack .../63-policycoreutils-dev_2.8-3_armhf.deb ...
Unpacking policycoreutils-dev (2.8-3) ...
Selecting previously unselected package python3-audit.
Preparing to unpack .../64-python3-audit_1%3a2.8.4-3_armhf.deb ...
Unpacking python3-audit (1:2.8.4-3) ...
Selecting previously unselected package python3-ipy.
Preparing to unpack .../65-python3-ipy_1%3a0.83-1_all.deb ...
Unpacking python3-ipy (1:0.83-1) ...
Selecting previously unselected package python3-semanage.
Preparing to unpack .../66-python3-semanage_2.8-2_armhf.deb ...
Unpacking python3-semanage (2.8-2) ...
Selecting previously unselected package policycoreutils-python-utils.
Preparing to unpack .../67-policycoreutils-python-utils_2.8-3_all.deb ...
Unpacking policycoreutils-python-utils (2.8-3) ...
Selecting previously unselected package proj-bin.
Preparing to unpack .../68-proj-bin_5.2.0-1_armhf.deb ...
Unpacking proj-bin (5.2.0-1) ...
Selecting previously unselected package python3-numpy.
Preparing to unpack .../69-python3-numpy_1%3a1.16.2-1_armhf.deb ...
Unpacking python3-numpy (1:1.16.2-1) ...
Selecting previously unselected package python3-gdal.
Preparing to unpack .../70-python3-gdal_2.4.0+dfsg-1+b1_armhf.deb ...
Unpacking python3-gdal (2.4.0+dfsg-1+b1) ...
Selecting previously unselected package python3-olefile.
Preparing to unpack .../71-python3-olefile_0.46-1_all.deb ...
Unpacking python3-olefile (0.46-1) ...
Selecting previously unselected package python3-pil:armhf.
Preparing to unpack .../72-python3-pil_5.4.1-2+deb10u1_armhf.deb ...
Unpacking python3-pil:armhf (5.4.1-2+deb10u1) ...
Selecting previously unselected package python3-scipy.
Preparing to unpack .../73-python3-scipy_1.1.0-7_armhf.deb ...
Unpacking python3-scipy (1.1.0-7) ...
Selecting previously unselected package python3-yaml.
Preparing to unpack .../74-python3-yaml_3.13-2_armhf.deb ...
Unpacking python3-yaml (3.13-2) ...
Selecting previously unselected package selinux-basics.
Preparing to unpack .../75-selinux-basics_0.5.6_all.deb ...
Unpacking selinux-basics (0.5.6) ...
Selecting previously unselected package selinux-policy-default.
Preparing to unpack .../76-selinux-policy-default_2%3a2.20190201-2_all.deb ...
Unpacking selinux-policy-default (2:2.20190201-2) ...
Selecting previously unselected package selinux-policy-dev.
Preparing to unpack .../77-selinux-policy-dev_2%3a2.20190201-2_all.deb ...
Unpacking selinux-policy-dev (2:2.20190201-2) ...
Selecting previously unselected package setools.
Preparing to unpack .../78-setools_4.2.0-1_armhf.deb ...
Unpacking setools (4.2.0-1) ...
Setting up python3-pkg-resources (40.8.0-1) ...
Setting up selinux-utils (2.8-1+b1) ...
Setting up semodule-utils (2.8-1) ...
Setting up liblcms2-2:armhf (2.9-3) ...
Setting up liblapack3:armhf (3.8.0-2) ...
update-alternatives: using /usr/lib/arm-linux-gnueabihf/lapack/liblapack.so.3 to provide /usr/lib/arm-linux-gnueabihf/liblapack.so.3 (liblapack.so.3-arm-linux-gn
ueabihf) in auto mode
Setting up libxerces-c3.2:armhf (3.2.2+debian-1+b1) ...
Setting up proj-data (5.2.0-1) ...
Setting up python3-semanage (2.8-2) ...
Setting up libcharls2:armhf (2.0.0+dfsg-1) ...
Setting up libminizip1:armhf (1.1-8+b1) ...
Setting up gawk (1:4.2.1+dfsg-1) ...
Setting up libyaml-0-2:armhf (0.2.1-1) ...
Setting up python3-olefile (0.46-1) ...
Setting up policycoreutils (2.8-1) ...
selinux-autorelabel-mark.service is a disabled or a static unit, not starting it.
Setting up libwebpdemux2:armhf (0.6.1-2) ...
Setting up libproj13:armhf (5.2.0-1) ...
Setting up libarpack2:armhf (3.7.0-2) ...
Setting up libpq5:armhf (11.7-0+deb10u1) ...
Setting up libsuperlu5:armhf (5.2.1+dfsg1-4) ...
Setting up proj-bin (5.2.0-1) ...
Setting up libdap25:armhf (3.20.3-1) ...
Setting up python3-yaml (3.13-2) ...
Setting up libqhull7:armhf (2015.2-4) ...
Setting up libepsilon1:armhf (0.9.2+dfsg-4) ...
Setting up libdapserver7v5:armhf (3.20.3-1) ...
Setting up libauparse0:armhf (1:2.8.4-3) ...
Setting up libgeos-3.7.1:armhf (3.7.1-1) ...
Setting up libaec0:armhf (1.0.2-1) ...
Setting up gdal-data (2.4.0+dfsg-1) ...
Setting up poppler-data (0.4.9-2) ...
Setting up libgeotiff2:armhf (1.4.3-1) ...
Setting up python3-decorator (4.3.0-1.1) ...
Setting up libnspr4:armhf (2:4.20-1) ...
Setting up selinux-policy-default (2:2.20190201-2) ...
Updating selinux default policy (this step might take a moment)... done.
Setting up checkpolicy (2.8-1) ...
Setting up libimagequant0:armhf (2.12.2-1.1) ...
Setting up libgeos-c1v5:armhf (3.7.1-1) ...
Setting up dracut (048+80-2) ...
dracut: Generating /boot/initrd.img-4.19.106-bone49
depmod: FATAL: could not load /boot/System.map-4.19.106-bone49-interim: No such file or directory
dracut: Generating /boot/initrd.img-4.19.106-bone49-interim
libkmod: ERROR ../libkmod/libkmod.c:586 kmod_search_moddep: could not open moddep file '/lib/modules/4.19.106-bone49-interim//modules.dep.bin'
libkmod: ERROR ../libkmod/libkmod.c:586 kmod_search_moddep: could not open moddep file '/lib/modules/4.19.106-bone49-interim//modules.dep.bin'
libkmod: ERROR ../libkmod/libkmod.c:586 kmod_search_moddep: could not open moddep file '/lib/modules/4.19.106-bone49-interim//modules.dep.bin'
libkmod: ERROR ../libkmod/libkmod.c:586 kmod_search_moddep: could not open moddep file '/lib/modules/4.19.106-bone49-interim//modules.dep.bin'
libkmod: ERROR ../libkmod/libkmod.c:586 kmod_search_moddep: could not open moddep file '/lib/modules/4.19.106-bone49-interim//modules.dep.bin'
libkmod: ERROR ../libkmod/libkmod.c:586 kmod_search_moddep: could not open moddep file '/lib/modules/4.19.106-bone49-interim//modules.dep.bin'
libkmod: ERROR ../libkmod/libkmod.c:586 kmod_search_moddep: could not open moddep file '/lib/modules/4.19.106-bone49-interim//modules.dep.bin'
libkmod: ERROR ../libkmod/libkmod.c:586 kmod_search_moddep: could not open moddep file '/lib/modules/4.19.106-bone49-interim//modules.dep.bin'
libkmod: ERROR ../libkmod/libkmod.c:586 kmod_search_moddep: could not open moddep file '/lib/modules/4.19.106-bone49-interim//modules.dep.bin'
libkmod: ERROR ../libkmod/libkmod.c:586 kmod_search_moddep: could not open moddep file '/lib/modules/4.19.106-bone49-interim//modules.dep.bin'
libkmod: ERROR ../libkmod/libkmod.c:586 kmod_search_moddep: could not open moddep file '/lib/modules/4.19.106-bone49-interim//modules.dep.bin'
libkmod: ERROR ../libkmod/libkmod.c:586 kmod_search_moddep: could not open moddep file '/lib/modules/4.19.106-bone49-interim//modules.dep.bin'
libkmod: ERROR ../libkmod/libkmod.c:586 kmod_search_moddep: could not open moddep file '/lib/modules/4.19.106-bone49-interim//modules.dep.bin'
libkmod: ERROR ../libkmod/libkmod.c:586 kmod_search_moddep: could not open moddep file '/lib/modules/4.19.106-bone49-interim//modules.dep.bin'
libkmod: ERROR ../libkmod/libkmod.c:586 kmod_search_moddep: could not open moddep file '/lib/modules/4.19.106-bone49-interim//modules.dep.bin'
libkmod: ERROR ../libkmod/libkmod.c:586 kmod_search_moddep: could not open moddep file '/lib/modules/4.19.106-bone49-interim//modules.dep.bin'
libkmod: ERROR ../libkmod/libkmod.c:586 kmod_search_moddep: could not open moddep file '/lib/modules/4.19.106-bone49-interim//modules.dep.bin'
libkmod: ERROR ../libkmod/libkmod.c:586 kmod_search_moddep: could not open moddep file '/lib/modules/4.19.106-bone49-interim//modules.dep.bin'
libkmod: ERROR ../libkmod/libkmod.c:586 kmod_search_moddep: could not open moddep file '/lib/modules/4.19.106-bone49-interim//modules.dep.bin'
libkmod: ERROR ../libkmod/libkmod.c:586 kmod_search_moddep: could not open moddep file '/lib/modules/4.19.106-bone49-interim//modules.dep.bin'
libkmod: ERROR ../libkmod/libkmod.c:586 kmod_search_moddep: could not open moddep file '/lib/modules/4.19.106-bone49-interim//modules.dep.bin'
libkmod: ERROR ../libkmod/libkmod.c:586 kmod_search_moddep: could not open moddep file '/lib/modules/4.19.106-bone49-interim//modules.dep.bin'
libkmod: ERROR ../libkmod/libkmod.c:586 kmod_search_moddep: could not open moddep file '/lib/modules/4.19.106-bone49-interim//modules.dep.bin'
libkmod: ERROR ../libkmod/libkmod.c:586 kmod_search_moddep: could not open moddep file '/lib/modules/4.19.106-bone49-interim//modules.dep.bin'
dracut: Cannot find module directory /lib/modules/4.19.106-bone49-interim/
dracut: and --no-kernel was not specified
dpkg: error processing package dracut (--configure):
 installed dracut package post-installation script subprocess returned error exit status 1
Setting up libodbc1:armhf (2.3.6-0.1) ...
Setting up python3-numpy (1:1.16.2-1) ...
Setting up libhdf4-0-alt (4.2.13-4) ...
Setting up python3-ipy (1:0.83-1) ...
Setting up libgif7:armhf (5.1.4-3) ...
Setting up liburiparser1:armhf (0.9.1-1) ...
Setting up libfreexl1:armhf (1.0.5-3) ...
Setting up libfyba0:armhf (4.1.1-6) ...
Setting up libkmlbase1:armhf (1.3.0-7) ...
Setting up libdapclient6v5:armhf (3.20.3-1) ...
Setting up python3-selinux (2.8-1+b1) ...
Setting up libopenjp2-7:armhf (2.3.0-2+deb10u1) ...
Setting up libarmadillo9 (1:9.200.7+dfsg-1) ...
Setting up libwebpmux3:armhf (0.6.1-2) ...
dpkg: dependency problems prevent configuration of cryptsetup-initramfs:
 cryptsetup-initramfs depends on initramfs-tools (>= 0.129) | linux-initramfs-tool; however:
  Package initramfs-tools is not installed.
  Package linux-initramfs-tool is not installed.
  Package initramfs-tools which provides linux-initramfs-tool is not installed.
  Package dracut which provides linux-initramfs-tool is not configured yet.

dpkg: error processing package cryptsetup-initramfs (--configure):
 dependency problems - leaving unconfigured
Setting up libsz2:armhf (1.0.2-1) ...
Setting up libkmlxsd1:armhf (1.3.0-7) ...
Setting up libkmldom1:armhf (1.3.0-7) ...
Setting up libspatialite7:armhf (4.3.0a-5+b2) ...
Setting up libogdi3.2 (3.2.1+ds-4) ...
Setting up python3-scipy (1.1.0-7) ...
Setting up libkmlengine1:armhf (1.3.0-7) ...
Setting up selinux-basics (0.5.6) ...
dpkg: dependency problems prevent configuration of cryptsetup:
 cryptsetup depends on cryptsetup-initramfs (>= 2:2.0.3-1); however:
  Package cryptsetup-initramfs is not configured yet.

dpkg: error processing package cryptsetup (--configure):
 dependency problems - leaving unconfigured
Setting up libkmlconvenience1:armhf (1.3.0-7) ...
Setting up libnss3:armhf (2:3.42.1-1+deb10u2) ...
Setting up python3-networkx (2.2-1) ...
Setting up python3-audit (1:2.8.4-3) ...
Setting up python3-pil:armhf (5.4.1-2+deb10u1) ...
Setting up libkmlregionator1:armhf (1.3.0-7) ...
Setting up libhdf5-103:armhf (1.10.4+repack-10) ...
Setting up python3-setools (4.2.0-1) ...
Setting up libpoppler82:armhf (0.71.0-5) ...
Setting up setools (4.2.0-1) ...
Setting up libnetcdf13:armhf (1:4.6.2-1) ...
Setting up python3-sepolgen (2.8-3) ...
Setting up python3-sepolicy (2.8-3) ...
Setting up policycoreutils-python-utils (2.8-3) ...
Setting up policycoreutils-dev (2.8-3) ...
Setting up selinux-policy-dev (2:2.20190201-2) ...
Setting up odbcinst (2.3.6-0.1) ...
Setting up odbcinst1debian2:armhf (2.3.6-0.1) ...
Setting up libgdal20 (2.4.0+dfsg-1+b1) ...
Setting up python3-gdal (2.4.0+dfsg-1+b1) ...
Processing triggers for libc-bin (2.28-10) ...
Processing triggers for systemd (241-7~deb10u4rcnee0~buster+20200509) ...
Processing triggers for man-db (2.8.5-2) ...
Errors were encountered while processing:
 dracut
 cryptsetup-initramfs
 cryptsetup
E: Sub-process /usr/bin/dpkg returned an error code (1)
root@arm:/home/debian#
```

If requested press Y to continue the installation process. Run apt update after finishing the installation.

### Enabling SELinux

To enable SELinux run the following command:

	# selinux-activate

#### BBB Debian Buster SELinux enabling example

	root@arm:/home/debian# selinux-activate
	Activating SE Linux
	SE Linux is activated.  You may need to reboot now.
	root@arm:/home/debian# sestatus
	SELinux status:                 disabled
	root@arm:/home/debian#

After reboot process:

	root@arm:/home/debian# sestatus
	SELinux status:                 disabled
	root@arm:/home/debian# selinux-activate
	Activating SE Linux
	SE Linux is activated.  You may need to reboot now.
	root@arm:/home/debian# sestatus
	SELinux status:                 disabled
	root@arm:/home/debian#

	(still disabled)

As you can see SELinux was properly activated. To apply all changes you must reboot your system as instructed.

### Command getenforce

The command getenforce can be used to learn the SELinux status, if its under permissive or enforcing mode:

	# getenforce

#### BBB Debian Buster SELinux getenforce example

	root@arm:/home/debian# getenforce
	Disabled
	root@arm:/home/debian# setenforce
	usage:  setenforce [ Enforcing | Permissive | 1 | 0 ]
	root@arm:/home/debian# setenforce 1
	setenforce: SELinux is disabled
	root@arm:/home/debian# setenforce 0
	setenforce: SELinux is disabled
	root@arm:/home/debian#

The permissive mode could be replaced by setting the parameter 1 (permissive is 0). You can also check the
mode on the configuration file using the command less:

	# less /etc/selinux/config

Output:

As you can see the configuration files show the permissive mode. Press Q to quit.

To see a file or process security context you can use the flag -Z:

	# ls -Z

The label format is user:role:type:level.

### semanage – SELinux Policy Management tool

semanage is the SELinux Policy Management tool. It allows to manage booleans (which allow to modify process
on the run), user roles and levels, network interfaces, policy modules and more. Semanage allows to configure
SELinux policies without the need to compile sources. Semanage allows the link between the OS and SELinux
users and certain objects security contexts.

For additional information on semanage visit the man page at: https://linux.die.net/man/8/semanage

### Conclusion and notes

SELinux is an additional way to administer access from processes to system resources such as files, partitions,
directories, etc. It allows to manage massive privileges according to role, level or type. Having it enabled
is a must as security measure and when using it is important to remember its security layer and to reboot the
system after enabling or disabling it (disabling isn’t recommended at all except for specific tests). Sometimes
a file access is blocked despite the system or OS permissions are granted because SELinux is forbidding it.

I hope you found this article on SELinux useful as introduction this security solution, keep following LinuxHint
for more tips and updates on Linux and networking.

### Literature

SELinux on Ubuntu Tutorial

https://linuxhint.com/selinux-on-ubuntu-tutorial/

